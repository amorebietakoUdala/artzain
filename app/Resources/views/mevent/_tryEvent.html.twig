{% extends 'base.html.twig' %}

{% block title %}{{'mevent.tryevent.izenburua' | trans }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('bower_components/bootstrap-table/dist/bootstrap-table.min.css') }}" rel="stylesheet" type="text/css">
    <link href="{{ asset('bower_components/jquery-ui/themes/base/jquery-ui.css') }}" rel="stylesheet" type="text/css">
    <link href="{{ asset('bower_components/fontawesome/css/font-awesome.min.css') }}" rel="stylesheet" type="text/css">
    <link href="{{ asset('bower_components/gijgo/dist/combined/css/gijgo.min.css') }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block message %}
    {% for msg in app.session.flashBag.get('success') %}
	<div class="alert alert-success margin-top-13">
	    {{ msg | trans}}
	</div>
    {% endfor %}
    {% for msg in app.session.flashBag.get('error') %}
	<div class="alert alert-danger margin-top-13">
	    {{ msg | trans}}
	</div>
    {% endfor %}
{% endblock %}


{% block body %}
    <main>
	{{ include('mevent/_tryEvent_form.html.twig',{
			    }) }}
	{% if findSuccess is defined %}
	<div id="event-success" class="container">
	    <b>{{ "Find Success" | trans }}:</b> {{ findSuccess }}
	</div>
	{% endif %}
	{% if findFailure is defined %}
	<div id="event-failure" class="container">
	    <b>{{ "Find Failure" | trans }}:</b> {{ findFailure }}
	</div>
	{% endif %}
	{% if event is defined %}
	<div id="event-subject" class="container mt-5">
	    <b>{{ "label.subject" | trans }}:</b> {{event.subject | replace({(mevent.successCondition):'<span class="highlight">'~(mevent.successCondition)~'</span>'}) | raw }}
	</div>
	<div id="event-details" class="container">
	    {% set body = ( event.details ) | striptags('<table><th><tr><td><p><b><span><a><br><blockguote>') | raw %}
	    {% set highlighted = body | replace ({(mevent.successCondition):'<span class="highlight">'~(mevent.successCondition)~'</span>'}) %}
	    {% if failureCondition is defined and failureCondition != null %}
		{% set highlighted = highlighted | replace ({(mevent.failureCondition):'<span class="highlight-danger">'~(mevent.failureCondition)~'</span>'}) %}
	    {% endif %}
	    {% if ( event.type == "text") %}
		<pre>
		    {{ highlighted | raw }}
		</pre>
	    {% else %}
		{{ highlighted | raw }}
	    {% endif %}
	</div>
	{% endif %}
	<div id="button-bottom-bar" class="container mt-5">
	    <button id="js-btn_cancel" class="btn btn-secondary" data-url="{{ path ('admin_mevent_dashboard',{'_locale': app.request.locale}) }}">{{ "button.cancel" | trans | capitalize }}</button>
	</div>
    </main>
{% endblock %}

{% block javascripts %}
    {{  parent() }}
    <script type="text/javascript" src="{{ asset('js/mevent_try.js') }}"></script>
    <script type="text/javascript">
    $(document).ready(function(){
	var view = View();
	view.onBtnSaveClick();
	view.onBtnTestClick();
	view.onBtnCancelClick();
    });
    </script>

{% endblock javascripts %}